function setCookie(e){document.cookie="proferotech-language="+e+"; domain=proferotech.com; path=/"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;n.length>o;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t)){var r=i.substring(t.length,i.length);return r=r.replace(/'/g,'"')}}return null}function resizePortfolioItems(){var e=$(".portfolio-item").get();for(i=0;e.length>i;i++){var t=$(e[i]),n=t.width(),o=t.data("bgoffset"),r=-o*n+"px 0";t.css({"background-position":r,height:n})}}function beforePrint(){$(".testimonials").cbpQTRotator("destroy")}function afterPrint(){$(".testimonials").cbpQTRotator("_init")}window.enquire=function(e){"use strict";function t(e,t){var n,o=0,i=e.length;for(o;i>o&&(n=t(e[o],o),n!==!1);o++);}function n(e){return"[object Array]"===Object.prototype.toString.apply(e)}function o(e){return"function"==typeof e}function i(e){this.options=e,!e.deferSetup&&this.setup()}function r(t,n){this.query=t,this.isUnconditional=n,this.handlers=[],this.mql=e(t);var o=this;this.listener=function(e){o.mql=e,o.assess()},this.mql.addListener(this.listener)}function s(){if(!e)throw Error("matchMedia not present, legacy browsers require a polyfill");this.queries={},this.browserIsIncapable=!e("only all").matches}return i.prototype={setup:function(){this.options.setup&&this.options.setup(),this.initialised=!0},on:function(){!this.initialised&&this.setup(),this.options.match&&this.options.match()},off:function(){this.options.unmatch&&this.options.unmatch()},destroy:function(){this.options.destroy?this.options.destroy():this.off()},equals:function(e){return this.options===e||this.options.match===e}},r.prototype={addHandler:function(e){var t=new i(e);this.handlers.push(t),this.mql.matches&&t.on()},removeHandler:function(e){var n=this.handlers;t(n,function(t,o){return t.equals(e)?(t.destroy(),!n.splice(o,1)):void 0})},clear:function(){t(this.handlers,function(e){e.destroy()}),this.mql.removeListener(this.listener),this.handlers.length=0},assess:function(){var e=this.mql.matches||this.isUnconditional?"on":"off";t(this.handlers,function(t){t[e]()})}},s.prototype={register:function(e,i,s){var a=this.queries,c=s&&this.browserIsIncapable;return a[e]||(a[e]=new r(e,c)),o(i)&&(i={match:i}),n(i)||(i=[i]),t(i,function(t){a[e].addHandler(t)}),this},unregister:function(e,t){var n=this.queries[e];return n&&(t?n.removeHandler(t):(n.clear(),delete this.queries[e])),this}},new s}(window.matchMedia),function(e){var t=!1,n=!1,o={isUrl:function(e){var t=RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i");return t.test(e)?!0:!1},loadContent:function(e,t){e.html(t)},addPrefix:function(e){var t=e.attr("id"),n=e.attr("class");"string"==typeof t&&""!==t&&e.attr("id",t.replace(/([A-Za-z0-9_.\-]+)/g,"sidr-id-$1")),"string"==typeof n&&""!==n&&"sidr-inner"!==n&&e.attr("class",n.replace(/([A-Za-z0-9_.\-]+)/g,"sidr-class-$1")),e.removeAttr("style")},execute:function(o,r,s){"function"==typeof r?(s=r,r="sidr"):r||(r="sidr");var a,c,l,u=e("#"+r),f=e(u.data("body")),d=e("html"),p=u.outerWidth(!0),h=u.data("speed"),g=u.data("side");if("open"===o||"toogle"===o&&!u.is(":visible")){if(u.is(":visible")||t)return;if(n!==!1)return i.close(n,function(){i.open(r)}),void 0;t=!0,"left"===g?(a={left:p+"px"},c={left:"0px"}):(a={right:p+"px"},c={right:"0px"}),l=d.scrollTop(),d.css("overflow-x","hidden").scrollTop(l),f.css({width:f.width(),position:"absolute"}).animate(a,h),u.css("display","block").animate(c,h,function(){t=!1,n=r,"function"==typeof s&&s(r)})}else{if(!u.is(":visible")||t)return;t=!0,"left"===g?(a={left:0},c={left:"-"+p+"px"}):(a={right:0},c={right:"-"+p+"px"}),l=d.scrollTop(),d.removeAttr("style").scrollTop(l),f.animate(a,h),u.animate(c,h,function(){u.removeAttr("style"),f.removeAttr("style"),e("html").removeAttr("style"),t=!1,n=!1,"function"==typeof s&&s(r)})}}},i={open:function(e,t){o.execute("open",e,t)},close:function(e,t){o.execute("close",e,t)},toogle:function(e,t){o.execute("toogle",e,t)}};e.sidr=function(t){return i[t]?i[t].apply(this,Array.prototype.slice.call(arguments,1)):"function"!=typeof t&&"string"!=typeof t&&t?(e.error("Method "+t+" does not exist on jQuery.sidr"),void 0):i.toogle.apply(this,arguments)},e.fn.sidr=function(t){var n=e.extend({name:"sidr",speed:200,side:"left",source:null,renaming:!0,body:"body"},t),r=n.name,s=e("#"+r);if(0===s.length&&(s=e("<div />").attr("id",r).appendTo(e("body"))),s.addClass("sidr").addClass(n.side).data({speed:n.speed,side:n.side,body:n.body}),"function"==typeof n.source){var a=n.source(r);o.loadContent(s,a)}else if("string"==typeof n.source&&o.isUrl(n.source))e.get(n.source,function(e){o.loadContent(s,e)});else if("string"==typeof n.source){var c="",l=n.source.split(",");if(e.each(l,function(t,n){c+='<div class="sidr-inner">'+e(n).html()+"</div>"}),n.renaming){var u=e("<div />").html(c);u.find("*").each(function(t,n){var i=e(n);o.addPrefix(i)}),c=u.html()}o.loadContent(s,c)}else null!==n.source&&e.error("Invalid Sidr Source");return this.each(function(){var t=e(this),n=t.data("sidr");n||(t.data("sidr",r),t.click(function(e){e.preventDefault(),i.toogle(r)}))})}}(jQuery),function(e){e.fn.touchwipe=function(t){var n={min_move_x:20,min_move_y:20,wipeLeft:function(){},wipeRight:function(){},wipeUp:function(){},wipeDown:function(){},preventDefaultEvents:!0};return t&&e.extend(n,t),this.each(function(){function e(){this.removeEventListener("touchmove",t),i=null,s=!1}function t(t){if(n.preventDefaultEvents&&t.preventDefault(),s){var o=t.touches[0].pageX,a=t.touches[0].pageY,c=i-o,l=r-a;Math.abs(c)>=n.min_move_x?(e(),c>0?n.wipeLeft():n.wipeRight()):Math.abs(l)>=n.min_move_y&&(e(),l>0?n.wipeDown():n.wipeUp())}}function o(e){1==e.touches.length&&(i=e.touches[0].pageX,r=e.touches[0].pageY,s=!0,this.addEventListener("touchmove",t,!1))}var i,r,s=!1;"ontouchstart"in document.documentElement&&this.addEventListener("touchstart",o,!1)}),this}}(jQuery);var languagePreference=getCookie("proferotech-language"),currentLanguage=-1!==window.location.href.indexOf("cn")?"chinese":"english",browserLanguage=window.navigator.userLanguage||window.navigator.language;if(browserLanguage=-1!==browserLanguage.indexOf("zh")?"chinese":"english",languagePreference?languagePreference!==currentLanguage&&(console.log("cookie language isn't the one the page is currently displayed in"),"english"===languagePreference?(console.log("cookie language is english so redirecting"),window.location=window.location.href.replace("http://proferotech.com/cn/","http://proferotech.com/")):(console.log("cookie language is chinese so redirecting"),window.location=window.location.href.replace("http://proferotech.com/","http://proferotech.com/cn/"))):"english"!==browserLanguage&&browserLanguage!==currentLanguage&&(console.log("no cookie, browser language is chinese, current language isn't chinese, redirecting"),window.location=window.location.href.replace("http://proferotech.com/","http://proferotech.com/cn/")),$(".language-toggle").click(function(){$(this).hasClass("chinese")?setCookie("chinese"):setCookie("english")}),$("document").ready(function(){function e(){n=i.getCenter()}function t(e,t,n,o){var r=new google.maps.Marker({map:i,position:new google.maps.LatLng(e,t),title:n||""});return r.setIcon(o),r}var n,o=$(".map-container"),i=new google.maps.Map(o[0],{zoom:15,disableDefaultUI:!0,disableDoubleClickZoom:!0,draggable:!1,keyboardShortcuts:!1,scrollwheel:!1,center:new google.maps.LatLng(39.917774,116.453311),mapTypeId:google.maps.MapTypeId.ROADMAP});if(google.maps.event.addDomListener(i,"idle",function(){e()}),google.maps.event.addDomListener(window,"resize",function(){i.setCenter(n)}),!s&&(s=t(39.917815,116.453311,"Us!","http://maps.google.com/mapfiles/ms/icons/red-dot.png"),navigator.geolocation)){var r,s=null;navigator.geolocation.getCurrentPosition(function(e){if(!r&&!s){var t={origin:new google.maps.LatLng(e.coords.latitude,e.coords.longitude),destination:new google.maps.LatLng(39.917815,116.453311),travelMode:google.maps.DirectionsTravelMode.DRIVING},n=new google.maps.DirectionsService,o=new google.maps.DirectionsRenderer;o.setMap(i),n.route(t,function(e,t){t==google.maps.DirectionsStatus.OK&&o.setDirections(e)})}})}}),throttle=function(e,t){var n,o,i,r,s=0,a=function(){s=new Date,i=null,r=e.apply(n,o)};return function(){var c=new Date,l=t-(c-s);return n=this,o=arguments,0>=l?(clearTimeout(i),i=null,s=c,r=e.apply(n,o)):i||(i=setTimeout(a,l)),r}},$("document").ready(function(){function e(){$(this).scrollTop()>150?$("#backtotop").addClass("shown"):$("#backtotop").removeClass("shown")}resizePortfolioItems(),$(window).resize(function(){resizePortfolioItems()}),$(".carousel").carousel(),$(".carousel").touchwipe({wipeLeft:function(){$(".carousel").carousel("next")},wipeRight:function(){$(".carousel").carousel("prev")}}),$("#backtotop").click(function(){$("html, body").animate({scrollTop:"0px"},800)}),$(".menu a").click(function(){var e=$(this).attr("href"),t=$(e).offset().top;$("html, body").animate({scrollTop:t},800)});var t=throttle(e,100);$(window).scroll(t)}),window.Modernizr=function(e,t,n){function o(e){y.cssText=e}function i(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function s(e,t){for(var o in e){var i=e[o];if(!r(i,"-")&&y[i]!==n)return"pfx"==t?i:!0}return!1}function a(e,t,o){for(var r in e){var s=t[e[r]];if(s!==n)return o===!1?e[r]:i(s,"function")?s.bind(o||t):s}return!1}function c(e,t,n){var o=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+b.join(o+" ")+o).split(" ");return i(t,"string")||i(t,"undefined")?s(r,t):(r=(e+" "+$.join(o+" ")+o).split(" "),a(r,t,n))}var l,u,f,d="2.6.2",p={},h=!0,g=t.documentElement,m="modernizr",v=t.createElement(m),y=v.style,w=({}.toString,"Webkit Moz O ms"),b=w.split(" "),$=w.toLowerCase().split(" "),x={},C=[],T=C.slice,L={}.hasOwnProperty;f=i(L,"undefined")||i(L.call,"undefined")?function(e,t){return t in e&&i(e.constructor.prototype[t],"undefined")}:function(e,t){return L.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=T.call(arguments,1),o=function(){if(this instanceof o){var i=function(){};i.prototype=t.prototype;var r=new i,s=t.apply(r,n.concat(T.call(arguments)));return Object(s)===s?s:r}return t.apply(e,n.concat(T.call(arguments)))};return o}),x.csstransitions=function(){return c("transition")};for(var E in x)f(x,E)&&(u=E.toLowerCase(),p[u]=x[E](),C.push((p[u]?"":"no-")+u));return p.addTest=function(e,t){if("object"==typeof e)for(var o in e)f(e,o)&&p.addTest(o,e[o]);else{if(e=e.toLowerCase(),p[e]!==n)return p;t="function"==typeof t?t():t,h!==void 0&&h&&(g.className+=" "+(t?"":"no-")+e),p[e]=t}return p},o(""),v=l=null,function(e,t){function n(e,t){var n=e.createElement("p"),o=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",o.insertBefore(n.lastChild,o.firstChild)}function o(){var e=v.elements;return"string"==typeof e?e.split(" "):e}function i(e){var t=m[e[h]];return t||(t={},g++,e[h]=g,m[g]=t),t}function r(e,n,o){if(n||(n=t),u)return n.createElement(e);o||(o=i(n));var r;return r=o.cache[e]?o.cache[e].cloneNode():p.test(e)?(o.cache[e]=o.createElem(e)).cloneNode():o.createElem(e),r.canHaveChildren&&!d.test(e)?o.frag.appendChild(r):r}function s(e,n){if(e||(e=t),u)return e.createDocumentFragment();n=n||i(e);for(var r=n.frag.cloneNode(),s=0,a=o(),c=a.length;c>s;s++)r.createElement(a[s]);return r}function a(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return v.shivMethods?r(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+o().join().replace(/\w+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(v,t.frag)}function c(e){e||(e=t);var o=i(e);return v.shivCSS&&!l&&!o.hasCSS&&(o.hasCSS=!!n(e,"article,aside,figcaption,figure,footer,header,hgroup,nav,section{display:block}mark{background:#FF0;color:#000}")),u||a(e,o),e}var l,u,f=e.html5||{},d=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,h="_html5shiv",g=0,m={};(function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",l="hidden"in e,u=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return e.cloneNode===void 0||e.createDocumentFragment===void 0||e.createElement===void 0}()}catch(n){l=!0,u=!0}})();var v={elements:f.elements||"abbr article aside audio bdi canvas data datalist details figcaption figure footer header hgroup mark meter nav output progress section summary time video",shivCSS:f.shivCSS!==!1,supportsUnknownElements:u,shivMethods:f.shivMethods!==!1,type:"default",shivDocument:c,createElement:r,createDocumentFragment:s};e.html5=v,c(t)}(this,t),p._version=d,p._domPrefixes=$,p._cssomPrefixes=b,p.testProp=function(e){return s([e])},p.testAllProps=c,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(h?" js "+C.join(" "):""),p}(this,this.document),function(e,t,n){function o(e){return"[object Function]"==m.call(e)}function i(e){return"string"==typeof e}function r(){}function s(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function a(){var e=v.shift();y=1,e?e.t?h(function(){("c"==e.t?d.injectCss:d.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),a()):y=0}function c(e,n,o,i,r,c,l){function u(t){if(!p&&s(f.readyState)&&(w.r=p=1,!y&&a(),f.onload=f.onreadystatechange=null,t)){"img"!=e&&h(function(){$.removeChild(f)},50);for(var o in E[n])E[n].hasOwnProperty(o)&&E[n][o].onload()}}var l=l||d.errorTimeout,f=t.createElement(e),p=0,m=0,w={t:o,s:n,e:r,a:c,x:l};1===E[n]&&(m=1,E[n]=[]),"object"==e?f.data=n:(f.src=n,f.type=e),f.width=f.height="0",f.onerror=f.onload=f.onreadystatechange=function(){u.call(this,m)},v.splice(i,0,w),"img"!=e&&(m||2===E[n]?($.insertBefore(f,b?null:g),h(u,l)):E[n].push(f))}function l(e,t,n,o,r){return y=0,t=t||"j",i(e)?c("c"==t?C:x,e,t,this.i++,n,o,r):(v.splice(this.i++,0,e),1==v.length&&a()),this}function u(){var e=d;return e.loader={load:l,i:0},e}var f,d,p=t.documentElement,h=e.setTimeout,g=t.getElementsByTagName("script")[0],m={}.toString,v=[],y=0,w="MozAppearance"in p.style,b=w&&!!t.createRange().compareNode,$=b?p:g.parentNode,p=e.opera&&"[object Opera]"==m.call(e.opera),p=!!t.attachEvent&&!p,x=w?"object":p?"script":"img",C=p?"script":x,T=Array.isArray||function(e){return"[object Array]"==m.call(e)},L=[],E={},P={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};d=function(e){function t(e){var t,n,o,e=e.split("!"),i=L.length,r=e.pop(),s=e.length,r={url:r,origUrl:r,prefixes:e};for(n=0;s>n;n++)o=e[n].split("="),(t=P[o.shift()])&&(r=t(r,o));for(n=0;i>n;n++)r=L[n](r);return r}function s(e,i,r,s,a){var c=t(e),l=c.autoCallback;c.url.split(".").pop().split("?").shift(),c.bypass||(i&&(i=o(i)?i:i[e]||i[s]||i[e.split("/").pop().split("?")[0]]),c.instead?c.instead(e,i,r,s,a):(E[c.url]?c.noexec=!0:E[c.url]=1,r.load(c.url,c.forceCSS||!c.forceJS&&"css"==c.url.split(".").pop().split("?").shift()?"c":n,c.noexec,c.attrs,c.timeout),(o(i)||o(l))&&r.load(function(){u(),i&&i(c.origUrl,a,s),l&&l(c.origUrl,a,s),E[c.url]=2})))}function a(e,t){function n(e,n){if(e){if(i(e))n||(f=function(){var e=[].slice.call(arguments);d.apply(this,e),p()}),s(e,f,t,0,l);else if(Object(e)===e)for(c in a=function(){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}(),e)e.hasOwnProperty(c)&&(!n&&!--a&&(o(f)?f=function(){var e=[].slice.call(arguments);d.apply(this,e),p()}:f[c]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),p()}}(d[c])),s(e[c],f,t,c,l))}else!n&&p()}var a,c,l=!!e.test,u=e.load||e.both,f=e.callback||r,d=f,p=e.complete||r;n(l?e.yep:e.nope,!!u),u&&n(u)}var c,l,f=this.yepnope.loader;if(i(e))s(e,0,f,0);else if(T(e))for(c=0;e.length>c;c++)l=e[c],i(l)?s(l,0,f,0):T(l)?d(l):Object(l)===l&&a(l,f);else Object(e)===e&&a(e,f)},d.addPrefix=function(e,t){P[e]=t},d.addFilter=function(e){L.push(e)},d.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",f=function(){t.removeEventListener("DOMContentLoaded",f,0),t.readyState="complete"},0)),e.yepnope=u(),e.yepnope.executeStack=a,e.yepnope.injectJs=function(e,n,o,i,c,l){var u,f,p=t.createElement("script"),i=i||d.errorTimeout;p.src=e;for(f in o)p.setAttribute(f,o[f]);n=l?a:n||r,p.onreadystatechange=p.onload=function(){!u&&s(p.readyState)&&(u=1,n(),p.onload=p.onreadystatechange=null)},h(function(){u||(u=1,n(1))},i),c?p.onload():g.parentNode.insertBefore(p,g)},e.yepnope.injectCss=function(e,n,o,i,s,c){var l,i=t.createElement("link"),n=c?a:n||r;i.href=e,i.rel="stylesheet",i.type="text/css";for(l in o)i.setAttribute(l,o[l]);s||(g.parentNode.insertBefore(i,g),h(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},$("document").ready(function(){$(".toggle-menu").sidr({name:"sidr-right",side:"right",source:"#menu-content"}),$(".sidr a").bind("click",function(){$.sidr("close","sidr-right")}),enquire.register("screen and (min-width:980px)",{match:function(){$.sidr("close","sidr-right")}})}),window.matchMedia){var mediaQueryList=window.matchMedia("print");mediaQueryList.addListener(function(e){e.matches?beforePrint():afterPrint()})}window.onbeforeprint=beforePrint,window.onafterprint=afterPrint,function(e,t){"use strict";var n=t.Modernizr;e.CBPQTRotator=function(t,n){this.$el=e(n),this._init(t)},e.CBPQTRotator.defaults={speed:700,easing:"ease",interval:8e3},e.CBPQTRotator.prototype={_init:function(t){this.options=e.extend(!0,{},e.CBPQTRotator.defaults,t),this._config(),this.$items.eq(this.current).addClass("current"),this.support&&this._setTransition(),this._startRotator()},_config:function(){this.$items=this.$el.children(".testimonial"),this.itemsCount=this.$items.length,this.current=0,this.support=n.csstransitions,this.support&&(this.$progress=e('<span class="progress"></span>').appendTo(this.$el))},_setTransition:function(){setTimeout(e.proxy(function(){this.$items.css("transition","all "+this.options.speed+"ms "+this.options.easing)},this),25)},_startRotator:function(){this.support&&this._startProgress(),setTimeout(e.proxy(function(){this.support&&this._resetProgress(),this._next(),this._startRotator()},this),this.options.interval)},_next:function(){this.$items.eq(this.current).removeClass("current"),this.current=this.current<this.itemsCount-1?this.current+1:0,this.$items.eq(this.current).addClass("current")},_startProgress:function(){setTimeout(e.proxy(function(){this.$progress.css({transition:"width "+this.options.interval+"ms linear",width:"100%"})},this),25)},_resetProgress:function(){this.$progress.css({transition:"none",width:"0%"})},destroy:function(){this.support&&(this.$items.css("transition","none"),this.$progress.remove()),this.$items.removeClass("current").css({position:"relative","z-index":100,"pointer-events":"auto",opacity:1})}};var o=function(e){t.console&&t.console.error(e)};e.fn.cbpQTRotator=function(t){if("string"==typeof t){var n=Array.prototype.slice.call(arguments,1);this.each(function(){var i=e.data(this,"cbpQTRotator");return i?e.isFunction(i[t])&&"_"!==t.charAt(0)?(i[t].apply(i,n),undefined):(o("no such method '"+t+"' for cbpQTRotator instance"),undefined):(o("cannot call methods on cbpQTRotator prior to initialization; attempted to call method '"+t+"'"),undefined)})}else this.each(function(){var n=e.data(this,"cbpQTRotator");n?n._init():n=e.data(this,"cbpQTRotator",new e.CBPQTRotator(t,this))});return this}}(jQuery,window),$("document").ready(function(){$(".testimonials").cbpQTRotator()});